<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.5">
<title>clCreateSubDevices</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<link rel="stylesheet" href="./asciidoctor.css">
</head>
<body id="clCreateSubDevices" class="article">
<div id="header">
<h1>clCreateSubDevices</h1>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Creates an array of sub-devices that each reference a non-intersecting set of compute units within <code>in_device</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c" data-lang="c">cl_int clCreateSubDevices(cl_device_id in_device,
                          const cl_device_partition_property *properties,
                          cl_uint num_devices,
                          cl_device_id *out_devices,
                          cl_uint *num_devices_ret)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="parameters">Parameters</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1"><code>in_device</code></dt>
<dd>
<p>The device to be partitioned.</p>
</dd>
<dt class="hdlist1"><code>properties</code></dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Specifies how <code>in_device</code> is to be partition described by a partition name and its corresponding value.
Each partition name is immediately followed by the corresponding desired value.
The list is terminated with 0.
The list of supported partitioning schemes is described in the table below.
Only one of the listed partitioning schemes can be specified in <code>properties</code>.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">cl_device_partition_property enum (Partition value)</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>CL_DEVICE_PARTITION_EQUALLY (unsigned int)</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Split the aggregate device into as many smaller aggregate devices as can be created, each containing n compute units.
The value n is passed as the value accompanying this property.
If n does not divide evenly into <code>CL_DEVICE_PARTITION_MAX_COMPUTE_UNITS</code>, then the remaining compute units are not used.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>CL_DEVICE_PARTITION_BY_COUNTS (unsigned int)</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>This property is followed by a <code>CL_DEVICE_PARTITION_BY_COUNTS_LIST_END</code> terminated list of compute unit counts.
For each nonzero count m in the list, a sub-device is created with m compute units in it.
<code>CL_DEVICE_PARTITION_BY_COUNTS_LIST_END</code> is defined to be 0.</p>
</div>
<div class="paragraph">
<p>The number of non-zero count entries in the list may not exceed <code>CL_DEVICE_PARTITION_MAX_SUB_DEVICES</code>.</p>
</div>
<div class="paragraph">
<p>The total number of compute units specified may not exceed <code>CL_DEVICE_PARTITION_MAX_COMPUTE_UNITS</code>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>CL_DEVICE_PARTITION_BY_- AFFINITY_DOMAIN (cl_device_affinity_domain)</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Split the device into smaller aggregate devices containing one or more compute units that all share part of a cache hierarchy.
The value accompanying this property may be drawn from the following list:</p>
</div>
<div class="paragraph">
<p><code>CL_DEVICE_AFFINITY_DOMAIN_NUMA</code> - Split the device into sub-devices comprised of compute units that share a NUMA node.</p>
</div>
<div class="paragraph">
<p><code>CL_DEVICE_AFFINITY_DOMAIN_L4_CACHE</code> - Split the device into sub-devices comprised of compute units that share a level 4 data cache.</p>
</div>
<div class="paragraph">
<p><code>CL_DEVICE_AFFINITY_DOMAIN_L3_CACHE</code> - Split the device into sub-devices comprised of compute units that share a level 3 data cache.</p>
</div>
<div class="paragraph">
<p><code>CL_DEVICE_AFFINITY_DOMAIN_L2_CACHE</code> - Split the device into sub-devices comprised of compute units that share a level 2 data cache.</p>
</div>
<div class="paragraph">
<p><code>CL_DEVICE_AFFINITY_DOMAIN_L1_CACHE</code> - Split the device into sub-devices comprised of compute units that share a level 1 data cache.</p>
</div>
<div class="paragraph">
<p><code>CL_DEVICE_AFFINITY_DOMAIN_NEXT_PARTITIONABLE</code> - Split the device along the next partitionable affinity domain.
The implementation shall find the first level along which the device or sub-device may be further subdivided in the order NUMA, L4, L3, L2, L1, and partition the device into sub-devices comprised of compute units that share memory subsystems at this level.</p>
</div>
<div class="paragraph">
<p>The user may determine what happened by calling <a href="clGetDeviceInfo.html"><code>clGetDeviceInfo</code></a> (<code>CL_DEVICE_PARTITION_TYPE</code>) on the sub-devices.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</dd>
<dt class="hdlist1"><code>num_devices</code></dt>
<dd>
<p>Size of memory pointed to by <code>out_devices</code> specified as the number of <code>cl_device_id</code> entries.</p>
</dd>
<dt class="hdlist1"><code>out_devices</code></dt>
<dd>
<p>The buffer where the OpenCL sub-devices will be returned.
If <code>out_devices</code> is NULL, this argument is ignored.
If <code>out_devices</code> is not NULL, <code>num_devices</code> must be greater than or equal to the number of sub-devices that <code>device</code> may be partitioned into according to the partitioning scheme specified in <code>properties</code>.</p>
</dd>
<dt class="hdlist1"><code>num_devices_ret</code></dt>
<dd>
<p>Returns the number of sub-devices that device may be partitioned into according to the partitioning scheme specified in <code>properties</code>.
If <code>num_devices_ret</code> is NULL, it is ignored.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="notes">Notes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Creates an array of sub-devices that each reference a non-intersecting set of compute units within <code>in_device</code>, according to a partition scheme given by <code>properties</code>.
The output sub-devices may be used in every way that the root (or parent) device can be used, including creating contexts, building programs, further calls to <code>clCreateSubDevices</code> and creating command-queues.
When a command-queue is created against a sub-device, the commands enqueued on the queue are executed only on the sub-device.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="errors">Errors</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Returns <code>CL_SUCCESS</code> if the partition is created successfully.
Otherwise, it returns a NULL value with the following error values returned in <code>errcode_ret</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_DEVICE</code> if <code>in_device</code> is not valid.</p>
</li>
<li>
<p><code>CL_INVALID_VALUE</code> if values specified in <code>properties</code> are not valid or if values specified in <code>properties</code> are valid but not supported by the device.</p>
</li>
<li>
<p><code>CL_INVALID_VALUE</code> if <code>out_devices</code> is not NULL and <code>num_devices</code> is less than the number of sub-devices created by the partition scheme.</p>
</li>
<li>
<p><code>CL_DEVICE_PARTITION_FAILED</code> if the partition name is supported by the implementation but <code>in_device</code> could not be further partitioned.</p>
</li>
<li>
<p><code>CL_INVALID_DEVICE_PARTITION_COUNT</code> if the partition name specified in <code>properties</code> is <code>CL_DEVICE_PARTITION_BY_COUNTS</code> and the number of sub-devices requested exceeds <code>CL_DEVICE_PARTITION_MAX_SUB_DEVICES</code> or the total number of compute units requested exceeds <code>CL_DEVICE_PARTITION_MAX_COMPUTE_UNITS</code> for <code>in_device</code>, or the number of compute units requested for one or more sub-devices is less than zero or the number of sub-devices requested exceeds <code>CL_DEVICE_PARTITION_MAX_COMPUTE_UNITS</code> for <code>in_device</code>.</p>
</li>
<li>
<p><code>CL_OUT_OF_RESOURCES</code> if there is a failure to allocate resources required by the OpenCL implementation on the device.</p>
</li>
<li>
<p><code>CL_OUT_OF_HOST_MEMORY</code> if there is a failure to allocate resources required by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="example1">Example</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A few examples that describe how to specify partition properties in <code>properties</code> argument to <code>clCreateSubDevices</code> are given below.</p>
</div>
<div class="paragraph">
<p>To partition a device containing 16 compute units into two sub-devices, each containing 8 compute units, pass the following in <code>properties</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    { CL_DEVICE_PARTITION_EQUALLY, 8, 0 }</pre>
</div>
</div>
<div class="paragraph">
<p>To partition a device with four compute units into two sub-devices with one sub-device containing 3 compute units and the other sub-device 1 compute unit, pass the following in <code>properties</code> argument:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    { CL_DEVICE_PARTITION_BY_COUNTS,
      3, 1, CL_DEVICE_PARTITION_BY_COUNTS_LIST_END, 0 }</pre>
</div>
</div>
<div class="paragraph">
<p>To split a device along the outermost cache line (if any), pass the following in <code>properties</code> argument:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    { CL_DEVICE_PARTITION_BY_AFFINITY_DOMAIN,
      CL_DEVICE_AFFINITY_DOMAIN_NEXT_PARTITIONABLE, 0 }</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="seealso">Also see</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="clGetDeviceInfo.html"><code>clGetDeviceInfo</code></a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="specification">Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://www.khronos.org/registry/cl/specs/opencl-2.1.pdf#page=85" target="_blank">OpenCL 2.1 API Specification, page 85</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="copyright">Copyright</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="copyright.html">Copyright &#169; 2007-2017 The Khronos Group Inc.</a></p>
</div>
</div>
</div>
</div>
</body>
</html>