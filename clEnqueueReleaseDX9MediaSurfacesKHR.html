<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.5">
<title>clEnqueueReleaseDX9MediaSurfacesKHR</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<link rel="stylesheet" href="./asciidoctor.css">
</head>
<body id="clEnqueueReleaseDX9MediaSurfacesKHR" class="article">
<div id="header">
<h1>clEnqueueReleaseDX9MediaSurfacesKHR</h1>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Release OpenCL memory objects that have been created from media surfaces.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-c" data-lang="c">cl_int clEnqueueReleaseDX9MediaSurfacesKHR(cl_command_queue command_queue,
                                           cl_uint num_objects,
                                           const cl_mem *mem_objects,
                                           cl_uint num_events_in_wait_list,
                                           const cl_event *event_wait_list,
                                           cl_event *event)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="parameters">Parameters</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1"><code>command_queue</code></dt>
<dd>
<p>A valid command-queue.</p>
</dd>
<dt class="hdlist1"><code>num_objects</code></dt>
<dd>
<p>The number of memory objects to be released in <code>mem_objects</code>.</p>
</dd>
<dt class="hdlist1"><code>mem_objects</code></dt>
<dd>
<p>A pointer to a list of OpenCL memory objects that were created from media surfaces.</p>
</dd>
<dt class="hdlist1"><code>num_events_in_wait_list</code>, <code>event_wait_list</code></dt>
<dd>
<p>Specify events that need to complete before this particular command can be executed.
If <code>event_wait_list</code> is NULL, then this particular command does not wait on any event to complete.
If <code>event_wait_list</code> is NULL, <code>num_events_in_wait_list</code> must be 0.
If <code>event_wait_list</code> is not NULL, the list of events pointed to by <code>event_wait_list</code> must be valid and <code>num_events_in_wait_list</code> must be greater than 0.
The events specified in <code>event</code> returns an event object that identifies this particular command and can be used to query or queue a wait for this particular command to complete.
<code>event</code> can be NULL in which case it will not be possible for the application to query the status of this command or queue a wait for this command to complete.
If the <code>event_wait_list</code> and the event arguments are not NULL, the <code>event</code> argument should not refer to an element of the <code>event_wait_list</code> array.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="notes">Notes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Used to release OpenCL memory objects that have been created from media surfaces.
The media surfaces are released by the OpenCL context associated with <code>command_queue</code>.</p>
</div>
<div class="paragraph">
<p>OpenCL memory objects created from media surfaces which have been acquired by OpenCL must be released by OpenCL before they may be accessed by the media adapter API.
Accessing a media surface while its corresponding OpenCL memory object is acquired is in error and will result in undefined behavior, including but not limited to possible OpenCL errors, data corruption, and program termination.</p>
</div>
<div class="paragraph">
<p>If <code>CL_CONTEXT_INTEROP_USER_SYNC</code> is not specified as <code>CL_TRUE</code> during context creation, <code>clEnqueueReleaseDX9MediaSurfacesKHR</code> provides the synchronization guarantee that any calls to media adapter APIs involving the interop device(s) used in the OpenCL context made after the call to <code>clEnqueueReleaseDX9MediaSurfacesKHR</code> will not start executing until after all events in <code>event_wait_list</code> are complete and all work already submitted to <code>command_queue</code> completes execution.
If the context was created with properties specifying <code>CL_CONTEXT_INTEROP_USER_SYNC</code> as <code>CL_TRUE</code>, the user is responsible for guaranteeing that any media adapter API calls involving the interop device(s) used in the OpenCL context made after <code>clEnqueueReleaseDX9MediaSurfacesKHR</code> will not start executing until after event returned by <code>clEnqueueReleaseDX9MediaSurfacesKHR</code> reports completion.</p>
</div>
<div class="paragraph">
<p>General information about sharing memory objects with DX9 follows.</p>
</div>
<div class="paragraph">
<p>The goal of this extension is to allow applications to use media surfaces as OpenCL memory objects.
This allows efficient sharing of data between OpenCL and selected adapter APIs (only DX9 for now).
If this extension is supported, an OpenCL image object can be created from a media surface and the OpenCL API can be used to execute kernels that read and/or write memory objects that are media surfaces.
Note that OpenCL memory objects may be created from the adapter media surface if and only if the OpenCL context has been created from that adapter.</p>
</div>
<div class="paragraph">
<p>If this extension is supported by an implementation, the string "cl_khr_dx9_media_sharing" will be present in the <code>CL_PLATFORM_EXTENSIONS</code> (see <a href="clGetPlatformInfo.html"><code>clGetPlatformInfo</code></a>) or <code>CL_DEVICE_EXTENSIONS</code> (see <a href="clGetDeviceInfo.html"><code>clGetDeviceInfo</code></a>).</p>
</div>
<div class="paragraph">
<p>As currently proposed the interfaces for this extension would be provided in <code>cl_dx9_media_sharing.h</code>.</p>
</div>
<div class="paragraph">
<div class="title">Surface formats for Media Surface Sharing</div>
<p>This section includes the D3D surface formats that are supported when the adapter type is one of the Direct 3D lineage.
Using a D3D surface format not listed here is an error.
To extend the use of this extension to support media adapters beyond DirectX9 tables similar to the ones in this section will need to be defined for the surface formats supported by the new media adapter.
All implementations that support this extension are required to support the NV12 surface format, the other surface formats supported are the same surface formats that the adapter you are sharing with supports as long as they are listed in the tables below (Tables 9.10.3 and 9.10.4).</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">FOUR CC code</th>
<th class="tableblock halign-left valign-top">CL image format (channel order, channel data type)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>FOURCC('N', 'V', '1', '2'), Plane 0</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>CL_R, CL_UNORM_INT8</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>FOURCC('N', 'V', '1', '2'), Plane 1</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>CL_RG, CL_UNORM_INT8</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>FOURCC('Y', 'V', '1', '2'), Plane 0</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>CL_R, CL_UNORM_INT8</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>FOURCC('Y', 'V', '1', '2'), Plane 1</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>CL_R, CL_UNORM_INT8</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>FOURCC('Y', 'V', '1', '2'), Plane 2</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>CL_R, CL_UNORM_INT8</code></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>In the table above, NV12 Plane 0 corresponds to the luminance (Y) channel and Plane 1 corresponds to the UV channels.
The YV12 Plane 0 corresponds to the Y channel, Plane 1 to the U channel and Plane 2 to the V channel.
Note that the YUV formats map to <code>CL_R</code> and <code>CL_RG</code> but do not perform any YUV to RGB conversion and vice-versa.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">D3D format</th>
<th class="tableblock halign-left valign-top">CL image format (channel order, channel data type)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>D3DFMT_R32F</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>CL_R, CL_FLOAT</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>D3DFMT_R16F</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>CL_R, CL_HALF_FLOAT</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>D3DFMT_L16</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>CL_R, CL_UNORM_INT16</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>D3DFMT_A8</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>CL_A, CL_UNORM_INT8</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>D3DFMT_L8</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>CL_R, CL_UNORM_INT8</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>D3DFMT_G32R32F</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>CL_RG, CL_FLOAT</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>D3DFMT_G16R16F</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>CL_RG, CL_HALF_FLOAT</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>D3DFMT_G16R16</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>CL_RG, CL_UNORM_INT16</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>D3DFMT_A8L8</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>CL_RG, CL_UNORM_INT8</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>D3DFMT_A32B32G32R32F</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>CL_RGBA, CL_FLOAT</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>D3DFMT_A16B16G16R16F</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>CL_RGBA, CL_HALF_FLOAT</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>D3DFMT_A16B16G16R16</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>CL_RGBA, CL_UNORM_INT16</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>D3DFMT_A8B8G8R8</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>CL_RGBA, CL_UNORM_INT8</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>D3DFMT_X8B8G8R8</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>CL_RGBA, CL_UNORM_INT8</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>D3DFMT_A8R8G8B8</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>CL_BGRA, CL_UNORM_INT8</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>D3DFMT_X8R8G8B8</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>CL_BGRA, CL_UNORM_INT8</code></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Note that D3D9 format names seem to imply that the order of the color channels are switched relative to OpenCL but this is not the case.
For example, layout of channels for each pixel for <code>D3DFMT_A32FB32FG32FR32F</code> is the same as <code>CL_RGBA</code>, <code>CL_FLOAT</code>.</p>
</div>
<div class="paragraph">
<p>Properties of media surface objects may be queried using <a href="clGetMemObjectInfo.html"><code>clGetMemObjectInfo</code></a> and <a href="clGetImageInfo.html"><code>clGetImageInfo</code></a> with <code>param_name</code> <code>CL_MEM_DX9_MEDIA_ADAPTER_TYPE_KHR</code>, <code>CL_MEM_DX9_MEDIA_SURFACE_INFO_KHR</code> and <code>CL_IMAGE_DX9_MEDIA_SURFACE_PLANE_KHR</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="errors">Errors</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Returns <code>CL_SUCCESS</code> returns <code>CL_SUCCESS</code> if the function is executed successfully.
If <code>num_objects</code> is 0 and &lt;`mem_objects`&gt; is NULL then the function does nothing and returns <code>CL_SUCCESS</code>.
Otherwise it returns one of the following errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_VALUE</code> if <code>num_objects</code> is zero and <code>mem_objects</code> is not a NULL value or if <code>num_objects</code> &gt; 0 and <code>mem_objects</code> is NULL.</p>
</li>
<li>
<p><code>CL_INVALID_MEM_OBJECT</code> if memory objects in <code>mem_objects</code> are not valid OpenCL memory objects or if memory objects in <code>mem_objects</code> have not been created from valid media surfaces.</p>
</li>
<li>
<p><code>CL_INVALID_COMMAND_QUEUE</code> if <code>command_queue</code> is not a valid command-queue.</p>
</li>
<li>
<p><code>CL_INVALID_CONTEXT</code> if context associated with <code>command_queue</code> was not created from a media object.</p>
</li>
<li>
<p><code>CL_DX9_MEDIA_SURFACE_NOT_ACQUIRED_KHR</code> if memory objects in <code>mem_objects</code> have not been previously been acquired using <a href="clEnqueueAcquireDX9MediaSurfacesKHR.html"><code>clEnqueueAcquireDX9MediaSurfacesKHR</code></a> or have been released using <code>clEnqueueReleaseDX9MediaSurfacesKHR</code> since the last time that they were acquired.</p>
</li>
<li>
<p><code>CL_INVALID_EVENT_WAIT_LIST</code> if <code>event_wait_list</code> is NULL and <code>num_event_in_wait_list</code> &gt; 0, or <code>event_wait_list</code> is not NULL and <code>num_event_in_wait_list</code> is 0, or if event objects in <code>event_wait_list</code> are not valid events.</p>
</li>
<li>
<p><code>CL_OUT_OF_HOST_MEMORY</code> if there is a failure to allocate resources required by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="seealso">Also see</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="cl_khr_dx9_media_sharing.html"><code>cl_khr_dx9_media_sharing</code></a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="specification">Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://www.khronos.org/registry/cl/specs/opencl-2.1-extensions.pdf#page=91" target="_blank">OpenCL 2.1 Extensions Specification, page 91</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="copyright">Copyright</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="copyright.html">Copyright &#169; 2007-2017 The Khronos Group Inc.</a></p>
</div>
</div>
</div>
</div>
</body>
</html>